---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%", 
  fig.width=10, 
  dpi=300
)
```

# Voronoise

<!-- badges: start -->
<!-- badges: end -->

The goal of voronoise is to make pretty pictures. It is a very minor tweak on the voronoi tesselations provided by the `ggforce` package. You can install the development (only) version of voronoise from GitHub with:

``` r
remotes::install_github("djnavarro/voronoise")
```

## Example

Create a tibble with columns specifying the x and y coordinates, and the colours to be associated with the corresponding Voronoi cell

```{r dataset}
library(voronoise)

set.seed(1)

dat <- tibble::tibble(
  x = runif(n = 50, min = .1, max = .9),
  y = runif(n = 50, min = .1, max = .9),
  shade = sample(colours(), size = 50, replace = TRUE)
)

dat
```

Set up a ggplot defined on the unit square, with an `"antiquewhite"` background:

```{r baseplot}
base <- ggplot(
  data = dat, 
  mapping = aes(x, y, fill = shade, group = 1)
) + 
  scale_fill_identity() +
  scale_x_continuous(expand = c(0, 0)) + 
  scale_y_continuous(expand = c(0, 0)) + 
  theme_mono("antiquewhite3") +
  coord_square()

base
```

The `base_plot()` function provides a convenient shorthand for the above:

```{r}
base_plot()
```

The default behaviour of `geom_voronoise()` is identical to `ggforce::geom_voronoi_tile()` with some parameter values changed. It does not perturb the location of any of the tiles:

```{r boring}
base + 
  geom_voronoise(fill = "antiquewhite2")
```

To perturb the tiles we need to pass it a `perturb` function:

```{r uniform}
base + 
  geom_voronoise(fill = "antiquewhite2") + 
  geom_voronoise(
    mapping = aes(fill = shade), 
    perturb = perturb_uniform()
  )  
```

It's not too hard to define whatever perturb function one would like:

```{r fall, message=FALSE}
library(dplyr)

perturb_fall <- function(data) {
  data %>% 
    group_by(group) %>% 
    mutate(
      y = y - rbeta(1, 3, 1) * min(y)
    ) %>% 
    ungroup()
}

base + 
  geom_voronoise(fill = "antiquewhite2") + 
  geom_voronoise(
    mapping = aes(fill = shade), 
    perturb = perturb_fall
  )  
```

The voronoise package comes with a couple of handy functions that will create custom perturbing functions. So a more typical use might look like this:

```{r}
set.seed(1)
base_plot() + 
  geom_voronoise(fill = "antiquewhite2") + 
  geom_voronoise(perturb = perturb_float(-90))
```


